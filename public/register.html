<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户注册</title>
    <script src="javascripts/jquery.min.js"></script>
    <script>
        /*日期格式化模块*/
        !function () {
            var a = function () {
                var b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r = arguments.length, s = Number(this);
                return 1e12 < s && (s = 1e3 * s), b = new Date(s), a.ten = function (a) {
                    return a > 9 ? a : "0" + a
                }, c = b.getFullYear(), d = a.ten(b.getMonth() + 1), 0 === r ? (e = new Date, f = s - e.getTime() > 0 ? "后" : "前", (g = Math.abs(c - e.getFullYear())) ? g + "年" + f : (h = Math.abs(d - e.getMonth() - 1)) ? h + "月" + f : (i = Math.abs(s - (new Date).getTime()), (j = Math.floor(i / 864e5)) ? j + "天" + f : (k = Math.floor(i / 36e5)) ? k + "小时" + f : (l = Math.floor(i / 6e4)) ? l + "分钟" + f : (m = Math.floor(i / 1e3), m ? m + "秒" + f : "刚刚"))) : (a.s = function (a) {
                    return a.replace("Y", c).replace("M", d).replace("D", n).replace("h", o).replace("m", p).replace("s", q)
                }, n = a.ten(b.getDate()), o = a.ten(b.getHours()), p = a.ten(b.getMinutes()), q = a.ten(b.getSeconds()), a.s(arguments[0]))
            };
            Number.prototype.dateInfo = a, String.prototype.dateInfo = a
        }();
    </script>
</head>
<body>
    <h1>注册</h1>
    <form action="/users/register" method="post">
        <div>
            <label for="username">用户名</label>
            <input id="username" type="text" name="username" placeholder="请输入用户名" required value="1"/>
        </div>
        <div>
            <label for="password">密码</label>
            <input id="password" type="text" name="password" placeholder="请输入密码" required value="1">
        </div>
        <div>
            <label for="repeat_password">确认密码</label>
            <input id="repeat_password" type="text" name="password" placeholder="请重新输入密码" required value="1">
        </div>
       <!-- <div>
            <label for="nickname">昵称</label>
            <input id="nickname" type="text" name="nickname" placeholder="请输入昵称"/>
        </div>
        <div>
            <label for="phone">手机号</label>
            <input id="phone" type="number" name="phone" placeholder="请输入手机号">
        </div>
        <div>
            <label for="email">Email</label>
            <input id="email" type="number" name="email" placeholder="请输入Email">
        </div>
        <div>
            <label for="head">上传头像</label>
            <input id="head" type="file" name="head" placeholder="请重新手机号">
        </div>
        <div>
            <label for="email">性别</label>
            <label for="man">男</label>
            <input id="man" type="radio" name="sex" placeholder="男" checked>
            <label for="woman">女</label>
            <input id="woman" type="radio" name="sex" placeholder="女">
        </div>-->
        <input type="submit" value="提交">
    </form>
    <button id="get">获取全部用户</button>
    <table id="table">
        <tr>
            <td>ID</td>
            <td>用户名</td>
            <td>密码</td>
            <td>权限</td>
            <td>性别</td>
            <td>头像</td>
            <td>邮箱</td>
            <td>生日</td>
            <td>昵称</td>
            <td>时间</td>
        </tr>
    </table>
    <h1>更新</h1>
    <form action="/users/update" method="post">
        <div>
            <label for="username">用户名</label>
            <input id="update_username" type="text" name="username" placeholder="请输入用户名" required value="1"/>
        </div>
        <div>
            <label for="password">密码</label>
            <input id="update_password" type="text" name="password" placeholder="请输入密码" required value="1">
        </div>
        <div>
            <label for="repeat_password">确认密码</label>
            <input id="update_repeat_password" type="text" name="password" placeholder="请重新输入密码" required value="1">
        </div>
        <!-- <div>
             <label for="nickname">昵称</label>
             <input id="nickname" type="text" name="nickname" placeholder="请输入昵称"/>
         </div>
         <div>
             <label for="phone">手机号</label>
             <input id="phone" type="number" name="phone" placeholder="请输入手机号">
         </div>
         <div>
             <label for="email">Email</label>
             <input id="email" type="number" name="email" placeholder="请输入Email">
         </div>
         <div>
             <label for="head">上传头像</label>
             <input id="head" type="file" name="head" placeholder="请重新手机号">
         </div>
         <div>
             <label for="email">性别</label>
             <label for="man">男</label>
             <input id="man" type="radio" name="sex" placeholder="男" checked>
             <label for="woman">女</label>
             <input id="woman" type="radio" name="sex" placeholder="女">
         </div>-->
        <input type="submit" value="提交">
    </form>
<script>
    var url = location.origin;
    var table = $('#table');
    $('#get').click(function () {
        $.ajax({
            url:url + '/users/get_users',
            dataType:'json',
            success:function (json) {
                var html = table.html();
                table.html('');
                $.each(json.data,function () {
                    html += '<tr>';
                    html += '<td>'+this._id +'</td>';
                    html += '<td>'+this.username +'</td>';
                    html += '<td>'+this.password +'</td>';
                    html += '<td>'+this.root +'</td>';
                    html += '<td>'+ (this.sex ? (this.sex === 1 ? '男' : '女' ): '未知' ) +'</td>';
                    html += '<td>'+this.head +'</td>';
                    html += '<td>'+this.email +'</td>';
                    html += '<td>'+this.birthday.dateInfo('Y-M-D') +'</td>';
                    html += '<td>'+this.nickname +'</td>';
                    html += '</tr>';
                });
                table.html(html);
            }
        });
    });
</script>
</body>
</html>